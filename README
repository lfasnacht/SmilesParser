See doc/design_document.pdf
